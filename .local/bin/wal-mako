#!/usr/bin/env bash
set -euo pipefail

WALJSON="$HOME/.cache/wal/colors.json"
CFGDIR="$HOME/.config/mako"
CFG="$CFGDIR/config"

mkdir -p "$CFGDIR"
[ -f "$WALJSON" ] || exit 0

bg=$(jq -r '.special.background' "$WALJSON")
fg=$(jq -r '.special.foreground' "$WALJSON")
c1=$(jq -r '.colors.color1' "$WALJSON")
c2=$(jq -r '.colors.color2' "$WALJSON")
c4=$(jq -r '.colors.color4' "$WALJSON")
c6=$(jq -r '.colors.color6' "$WALJSON")

cat > "$CFG" <<EOF
# Auto-generated by wal-mako from ~/.cache/wal/colors.json
font=monospace 10
default-timeout=5000
max-visible=3
width=300
margin=10,10,10,10
padding=10
border-size=2
border-radius=10

background-color=$bg
text-color=$fg
border-color=$c6
EOF

# Reload mako to apply new colors
pkill mako 2>/dev/null || true
mako & disown

